<?xml version="1.0"?>

<!DOCTYPE PointOp SYSTEM "geglopgen.dtd">


<PointOp name="blend"  arguments="const Buffer src1, const Buffer src2">
  <description>
The blend operator blends two pixel sources together based on their alpha channels. src1 over src2.
  </description>
  <author>Jay Cox</author>
  <copyright>2001, Jay Cox</copyright>
  <license>GPL</license>

  <variables>
    /* This function don't need no variables */
  </variables>
  <constructor>
  </constructor>
  <destructor>
  </destructor>
  <PointProcessor precision="all" colormodel="all">
    <variables>
    /* This function don't need no variables */
    </variables>
    <per_pixel>     
    /* This function don't need no per pixel */
    </per_pixel>
    <per_color>
<![CDATA[
    dest = (src1 * src1_alpha + 
            src2 * ((CHANNEL_MAX - src1_alpha) * src2_alpha)) /
          (CHANNEL_MAX - (CHANNEL_MAX - src1_alpha)*(CHANNEL_MAX - src2_alpha))
]]>
    </per_color>
    <per_alpha>
<![CDATA[
      dest = src1 + (CHANNEL_MAX - src1) * src2;
]]>
    </per_alpha>
    <cleanup>
    /* no cleanup needed for this function */
    </cleanup>
  </PointProcessor>
</PointOp>
